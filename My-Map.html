<!DOCTYPE html>
<html>
<head>
<meta charset='utf-8' />
<title>Add Popup to a marker</title>
<meta name='viewport' content='initial-scale=1,maximum-scale=1,user-scalable=no' />
<script src='https://api.mapbox.com/mapbox-gl-js/v1.8.0/mapbox-gl.js'></script>
<link href='https://api.mapbox.com/mapbox-gl-js/v1.8.0/mapbox-gl.css' rel='stylesheet' />
<style>
            body { margin:0px; padding:0px; }
            #map { position:absolute; top:0px; bottom:0px; width:100%; }
        </style>
</head>
<body>
<style>
            
            #markerWithExternalCss {
                background-image: url('my-marker.png');
                background-size: cover;
                width: 50px;
                height: 50px;
                border-radius: 50%;
                cursor: pointer;
            }

        </style>
<div id='map'></div>
<script>
            //Add your LocationIQ Maps Access Token here (not the API token!)
            locationiqKey = 'pk.5dcc7345e3b6b79383e6021a44bed5bb';
            //Define the map and configure the map's theme
            var map = new mapboxgl.Map({
                container: 'map',
                attributionControl: false, //need this to show a compact attribution icon (i) instead of the whole text
                style: 'https://tiles.locationiq.com/v2/streets/vector.json?key='+locationiqKey,
                zoom: 12,
                center: [-1.45723343, 52.27519523]
            });
                        
            //Two ways to attach the popup to markers
            //https://www.mapbox.com/mapbox-gl-js/api#popup
            
            //1. Add it while creating the marker
            // Create a popup
            var popup = new mapboxgl.Popup()
                .setHTML('<b>Plate Number:</b> SF001<br> <b>Type:</b> Truck');
            
            var el = document.createElement('div');
            el.id = 'markerWithExternalCss';
            // finally, create the marker
            var markerWithExternalCss = new mapboxgl.Marker(el)
                .setLngLat([-1.35346413,52.27398732])
                .setPopup(popup)
                .addTo(map);
        
            //2. Add it after the marker is created
            var el = document.createElement('div');
            el.id = 'markerWithExternalCss';
            // finally, create the marker
            var markerWithExternalCss2 = new mapboxgl.Marker(el)
                .setLngLat([-1.37620926, 52.27866123])
                .addTo(map);
            
            var popup2 = new mapboxgl.Popup()
                .setHTML('<b>Plate Number:</b> SF002<br> <b>Type:</b> Car');

            //Attach to the marker we just created
            markerWithExternalCss2.setPopup(popup2); // sets a popup on this marker

	    

	    //add the json data
            var thedata = [
    
    [
        "1 UK 22028",
        "Riverways Farm",
        "New Bath Road",
        "",
        "",
        "Twyford",
        "RG10 9RY",
        "England",
        "Packing Centre (Egg)",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "EPC (Packing Centre)",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "Section: X (EPC)",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "Yes",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "Wokingham",
        "Wokingham",
        "51.4849367324971",
        "-0.879379330937731",
        ""
    ],
    [
        "1005",
        "Banner Foods (Bromsgrove) Limited",
        "6 - 12 Finstall Road",
        "",
        "Astonfields",
        "Bromsgrove",
        "B60 2DZ",
        "England",
        "Processing Plant (Meat) Re-Wrappingand repackaging establishment Cutting Plant (Red) Cutting Plant (Poultry) Mince Meat Establishment Meat Preparation Establishment",
        "RW (Re-Wrappingand repackaging establishment)(General)",
        "CP (Cutting Plant)",
        "CP (Cutting Plant)",
        "",
        "",
        "MM (Mince Meat Establishment) MP (Meat Preparation Establishment)",
        "PP (Processing Plant)",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "Section: VI (PP) Section: 0 (RW) Section: I (CP) Section: II (CP) Section: V (MM) Section: V (MP)",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "Yes",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "Yes",
        "Yes",
        "",
        "",
        "",
        "Yes",
        "",
        "Yes",
        "",
        "",
        "",
        "",
        "Food Standards Agency",
        "Bromsgrove District",
        "52.3229946298102",
        "-2.04797665139556",
        "No"
    ],
    [
        "1026",
        "Simon D Hall Anne M Hall & John D Hall (T/A Halls Poultry)",
        "Rushyford Farm",
        "",
        "Rushyford",
        "Ferryhill",
        "DL17 0LJ",
        "England",
        "Cutting Plant (Red) Cutting Plant (Poultry) Mince Meat Establishment Meat Preparation Establishment Cold Store",
        "CS (Cold Store)(General)",
        "CP (Cutting Plant)",
        "CP (Cutting Plant)",
        "",
        "",
        "MM (Mince Meat Establishment) MP (Meat Preparation Establishment)",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "Section: I (CP) Section: II (CP) Section: V (MM) Section: V (MP) Section: 0 (CS)",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "Yes",
        "Yes",
        "",
        "",
        "",
        "",
        "",
        "",
        "Yes",
        "Yes",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "Food Standards Agency",
        "County Durham",
        "54.6548263346852",
        "-1.56185892496543",
        ""
    ],
    [
        "1034",
        "Bartlett & Sons Ltd",
        "5-9 Cheltenham Street",
        "Cheltenham Street",
        "",
        "Bath",
        "BA2 3EX",
        "England",
        "Processing Plant (Meat) Cold Store Re-Wrappingand repackaging establishment Cutting Plant (Red) Cutting Plant (Poultry) Mince Meat Establishment Meat Preparation Establishment",
        "CS (Cold Store) RW (Re-Wrappingand repackaging establishment)(General)",
        "CP (Cutting Plant)",
        "CP (Cutting Plant)",
        "",
        "",
        "MM (Mince Meat Establishment) MP (Meat Preparation Establishment)",
        "PP (Processing Plant)",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "Section: VI (PP) Section: 0 (CS) Section: 0 (RW) Section: I (CP) Section: II (CP) Section: V (MM) Section: V (MP)",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "Yes",
        "Yes",
        "",
        "",
        "",
        "",
        "",
        "",
        "Yes",
        "Yes",
        "",
        "",
        "",
        "Yes",
        "",
        "Yes",
        "",
        "",
        "",
        "",
        "Food Standards Agency",
        "Bath and North East Somerset",
        "51.3786703761003",
        "-2.36965538130691",
        "No"
    ],
    [
        "1049",
        "Bredbury Catering Ltd",
        "Unit 3",
        "Hammond Avenue",
        "",
        "Stockport",
        "SK4 1PQ",
        "England",
        "Cold Store Re-Wrappingand repackaging establishment Cutting Plant (Red) Cutting Plant (Poultry) Mince Meat Establishment Meat Preparation Establishment",
        "CS (Cold Store) RW (Re-Wrappingand repackaging establishment)(General)",
        "CP (Cutting Plant)",
        "CP (Cutting Plant)",
        "",
        "",
        "MM (Mince Meat Establishment) MP (Meat Preparation Establishment)",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "Section: 0 (CS) Section: 0 (RW) Section: I (CP) Section: II (CP) Section: V (MM) Section: V (MP)",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "Yes",
        "Yes",
        "",
        "",
        "",
        "",
        "",
        "",
        "Yes",
        "Yes",
        "",
        "",
        "",
        "",
        "",
        "Yes",
        "",
        "",
        "",
        "",
        "Food Standards Agency",
        "Stockport",
        "53.428287",
        "-2.165041",
        ""
    ],
    [
        "1051",
        "Colin Clark & Sons Ltd (T/A Little Angus)",
        "Manor Farm",
        "Dorchester Road",
        "Grimstone",
        "Dorchester",
        "DT2 9NA",
        "England",
        "Cold Store Cutting Plant (Red) Cutting Plant (Poultry) Cutting Plant (Wild Game) Mince Meat Establishment Meat Preparation Establishment",
        "CS (Cold Store)(General)",
        "CP (Cutting Plant)",
        "CP (Cutting Plant)",
        "",
        "CP (Cutting Plant)",
        "MM (Mince Meat Establishment) MP (Meat Preparation Establishment)",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "Section: 0 (CS) Section: I (CP) Section: II (CP) Section: IV (CP) Section: V (MM) Section: V (MP)",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "Yes",
        "Yes",
        "",
        "",
        "",
        "",
        "",
        "",
        "Yes",
        "Yes",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "Food Standards Agency",
        "West Dorset District",
        "50.7467991532107",
        "-2.51221754453198",
        ""
    ],
    [
        "1052",
        "Freshasia Foods Ltd",
        "Unit 21 & 27 ",
        "Hailey Road",
        "",
        "Erith",
        "DA18 4AA",
        "England",
        "Cold Store Cutting Plant (Red) Meat Preparation Establishment Processing Plant (Fish) Re-Wrappingand repackaging establishment",
        "CS (Cold Store) RW (Re-Wrappingand repackaging establishment)(General)",
        "CP (Cutting Plant)",
        "",
        "",
        "",
        "MP (Meat Preparation Establishment)",
        "",
        "",
        "PP (Processing Plant)",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "Section: 0 (CS) Section: I (CP) Section: V (MP) Section: VIII (PP) Section: 0 (RW)",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "Yes",
        "Yes",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "Yes",
        "",
        "",
        "",
        "Yes",
        "",
        "Yes",
        "",
        "",
        "",
        "",
        "Food Standards Agency",
        "Bexley (London Borough)",
        "51.4963265145948",
        "0.149271614885341",
        "No"
    ],
    [
        "1056",
        "HAS Meat Limited",
        "Unit 14",
        "Rangemoor Road",
        "Tottenham",
        "London",
        "N15 4NA",
        "England",
        "Cold Store Cutting Plant (Red) Cutting Plant (Poultry) Mince Meat Establishment Meat Preparation Establishment",
        "CS (Cold Store)(General)",
        "CP (Cutting Plant)",
        "CP (Cutting Plant)",
        "",
        "",
        "MM (Mince Meat Establishment) MP (Meat Preparation Establishment)",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "Section: 0 (CS) Section: I (CP) Section: II (CP) Section: V (MM) Section: V (MP)",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "Yes",
        "Yes",
        "",
        "",
        "",
        "",
        "",
        "",
        "Yes",
        "Yes",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "Food Standards Agency",
        "Haringey (London Borough)",
        "51.582904",
        "-0.069358",
        ""
    ],
    [
        "1066",
        "Temple Meats Ltd",
        "A2 Bow Bridge Close",
        "",
        "Templeborough Enterprise Park",
        "Rotherham",
        "S60 1BY",
        "England",
        "Processing Plant (Meat) Cold Store Re-Wrappingand repackaging establishment Cutting Plant (Red) Cutting Plant (Poultry) Mince Meat Establishment Meat Preparation Establishment",
        "CS (Cold Store) RW (Re-Wrappingand repackaging establishment)(General)",
        "CP (Cutting Plant)",
        "CP (Cutting Plant)",
        "",
        "",
        "MM (Mince Meat Establishment) MP (Meat Preparation Establishment)",
        "PP (Processing Plant)",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "Section: VI (PP) Section: 0 (CS) Section: 0 (RW) Section: I (CP) Section: II (CP) Section: V (MM) Section: V (MP)",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "",
        "Yes",
        "Yes",
        "",
        "",
        "",
        "",
        "",
        "",
        "Yes",
        "Yes",
        "",
        "",
        "",
        "Yes",
        "",
        "Yes",
        "",
        "",
        "",
        "",
        "Food Standards Agency",
        "Rotherham",
        "53.422541",
        "-1.363735",
        ""
    ]
]

	  //add iterate for the code
	  for(var arec of thedata){
	  	console.log(arec);
		 var longi = parseFloat(arec[69]);
		 var lati = parseFloat(arec[68]);
		 //1. Add it while creating the marker
                 // Create a popup
                 var popup = new mapboxgl.Popup()
			  .setHTML('<b>Food Processor:</b>company name <br> <b>Type of Processor:</b> shop<br><b>Address:</b>the street');
                            
                 var el = document.createElement('div');
                 el.id = 'markerWithExternalCss';
                 // finally, create the marker
                 var markerWithExternalCss = new mapboxgl.Marker(el)
                 	.setLngLat([longi,lati])
                        .setPopup(popup)
                        .addTo(map);





	  }

        </script>
</body>
</html>


